# Coturn TURN server configuration for Nebula

# Listening ports
# Use 443 as primary so school firewalls allow traffic through
listening-port=443
alt-listening-port=3478

# Listen on all interfaces
listening-ip=0.0.0.0

# External/relay IP (your public IP)
external-ip=209.92.184.6

# Relay IP range (using high ports to avoid conflicts)
min-port=61000
max-port=61100

# TURN server realm and credentials
realm=nebula.turn
server-name=nebula-turn

# Static user credentials (long-term)
user=nebula:NebulaTurn2026!

# No TLS (plain TURN on 443 - port number is what matters for firewalls)
no-tls
no-dtls

# Fingerprinting
fingerprint

# Long-term credential mechanism
lt-cred-mech

# Security
no-multicast-peers
no-cli

# Logging
log-file=stdout
verbose

# Don't let TURN relay to private IPs (security)
denied-peer-ip=0.0.0.0-0.255.255.255
denied-peer-ip=10.0.0.0-10.255.255.255
denied-peer-ip=100.64.0.0-100.127.255.255
denied-peer-ip=127.0.0.0-127.255.255.255
denied-peer-ip=169.254.0.0-169.254.255.255
denied-peer-ip=192.0.0.0-192.0.0.255
denied-peer-ip=192.88.99.0-192.88.99.255
denied-peer-ip=198.18.0.0-198.19.255.255
denied-peer-ip=198.51.100.0-198.51.100.255
denied-peer-ip=203.0.113.0-203.0.113.255
denied-peer-ip=240.0.0.0-255.255.255.255

# BUT allow Docker bridge network (172.17.x.x) so TURN can relay to neko containers
allowed-peer-ip=172.17.0.0-172.31.255.255
# Also allow the host-mapped ports on 192.168.x.x
allowed-peer-ip=192.168.0.0-192.168.255.255
